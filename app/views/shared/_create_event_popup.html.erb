<div ng-controller="createEventController">
  <div class="modal fade" id="createEventModal" tabindex="-1" role="dialog" aria-labelledby="createEventModal">
    <div class="modal-dialog" role="document">
      <div class="modal-content">

        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">Add an Event</h4>
        </div>

        <form name="creationEventForm">

          <div class="modal-body">

            <div class="row">
              <div class="col-md-12">
                <h4>Sport Information</h4>
              </div>
            </div>

            <div class="row">

              <div class="form-group col-md-8">
                <angucomplete-alt id="sportCreation"
                          selected-object="creationSportSelected"
                          title-field="name"
                          search-fields="name"
                          placeholder="Choose your sport"
                          minlength="1"
                          local-data="sports"
                          text-searching="Finding matching Universities"
                          text-no-results="Sorry, sport not found"
                          auto-match="true"
                          focus-first="true"
                          input-class="form-control form-control-small"
                          pause="0"
                          input-changed="creationSportUpdated"
                          quantity="8"
                          match-class="highlightLetters"
                          field-required="true"
                          input-name="sport">
                </angucomplete-alt>
              </div>

              <div class="form-group col-md-4">
                <select class="form-control" ng-model="selectedLevelString" ng-change="updateLevelValue()">
                  <option selected="selected">Any level</option>
                  <option>Beginner</option>
                  <option>Intermediate</option>
                  <option>Advanced</option>
                </select>
              </div>

            </div>

            <div class="row">

              <div class="form-group col-md-12">
                <input type="number"
                  class="form-control"
                  placeholder="How many other people do you need? (min: 1)"
                  ng-model="event.needed"></input>
              </div>

            </div>

            <div class="row row-eq-height">

              <div class="col-md-6">

                <h4>Date and Time</h4>

                <div class="form-group">
                  <div id="creationDatePicker" class="input-group date" data-provide="datepicker" data-date-format="DD dd MM yyyy" data-date-autoclose="true"
                      data-date-clear-btn="true" data-date-today-highlight="true" data-date-max-view-mode="0" data-date-start-date="today">
                    <input type="button" class="form-control" ng-model="tests().test" id="creationDate" ng-required="true" readonly>
                    <div class="input-group-addon">
                      <i class="fa fa-calendar" aria-hidden="true"></i>
                    </div>
                  </div>
                </div>

                <div class="col-md-12" ng-show="creationEventForm.endTime.$touched">
                  <div ng-show="validTimeInputed()">The starting time must be before the ending time</div>
                </div>

                <div class="form-group">
                    <div class='input-group date' id='datetimepickerStart'>
                        <input type='button'
                               name="startTime"
                               class="form-control"
                               ng-model="event.start_time"
                               ng-required="true"
                               ng-click="openStartTimePicker()"
                               value="15:00"/>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>

                <div class="form-group">
                    <div class='input-group date' id='datetimepickerEnd'>
                        <input type='button'
                               name="endTime"
                               class="form-control"
                               ng-model="event.end_time"
                               ng-required="true"
                               ng-click="openEndTimePicker()"
                               value="16:00"/>
                        <span class="input-group-addon">
                            <span class="glyphicon glyphicon-time"></span>
                        </span>
                    </div>
                </div>

                <div class="col-md-12" ng-show="creationEventForm.endTime.$touched">
                  <div ng-show="validTimeInputed()">The starting time must be before the ending time</div>
                </div>

              </div>

              <div class="col-md-6">

                <h4>Location</h4>

                <div class="form-group">
                  <angucomplete-alt id="locationSelection"
                            selected-object="creationLocationSelected"
                            title-field="university_name"
                            search-fields="university_name"
                            placeholder="Choose your university location"
                            minlength="1"
                            local-data="universities"
                            text-searching="Finding matching Universities"
                            text-no-results="Sorry, university not found"
                            auto-match="true"
                            focus-first="true"
                            input-class="form-control form-control-small"
                            pause="0"
                            input-changed="creationLocationUpdated"
                            quantity="5"
                            match-class="highlightLetters"
                            field-required="true"
                            field-required-class="required"
                            input-name="location">
                  </angucomplete-alt>
                </div>

                <div class="col-md-12" ng-show="creationEventForm.location.$touched">
                  <div ng-show="creationEventForm.location.$error.required
                        && creationEventForm.location.$isEmpty(event.university_location)">University location required</div>
                  <div ng-show="creationEventForm.location.$error.required
                        && !creationEventForm.location.$isEmpty(event.university_location)">University location not valid</div>
                </div>

                <div class="form-group">
                  <textarea type="text"
                    name="locationField"
                    class="form-control location-text-area"
                    placeholder="Choose exact location description"
                    ng-model="event.location"
                    ng-required="true">
                  </textarea>
                </div>

                <div class="col-md-12" ng-show="creationEventForm.locationField.$touched">
                  <div ng-show="creationEventForm.locationField.$error.required">Exact location required</div>
                </div>

              </div>

            </div>

            <div ng-show="askForTelephone()">

              <div class="row">
                <div class="col-md-12">
                  <h4>Register Phone Number</h4>
                </div>
              </div>

              <div class="row">
                <div class="form-group col-md-12">
                  <input type="number"
                    name="phoneNumber"
                    class="form-control"
                    placeholder="Participants will need it to contact you"
                    ng-model="event.phone"
                    ng-required="askForTelephone()"
                    ng-minlength="5"
                    ng-maxlength="20"></input>
                </div>
              </div>

              <div class="col-md-12" ng-show="creationEventForm.phoneNumber.$touched">
                <div ng-show="creationEventForm.phoneNumber.$error.required">Phone number required</div>
                <div class="col-md-12" ng-show="!creationEventForm.phoneNumber.$error.required">
                  <div ng-show="creationEventForm.phoneNumber.$error.minlength">Phone Number too short, it must be at least 5 characters long</div>
                  <div ng-show="creationEventForm.phoneNumber.$error.maxlength">Phone Number too long, it must be a maximum of 20 characters long</div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-12">
                <h4>Additional Information</h4>
              </div>
            </div>

            <!-- end of TODO -->

            <div class="form-group">
              <textarea type="text"
                  rows="3"
                  class="form-control optionalForm"
                  placeholder="Add here any additional info related to the event"
                  aria-describedby="sizing-addon2"
                  ng-model="event.additional_info">
              </textarea>
            </div>

          </div>

          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            <!-- FIXME: dissmiss only on success -->
            <button type="button" class="btn btn-primary" data-dismiss="modal" ng-click="createEvent()" ng-disabled="creationEventForm.$invalid">Save changes</button>
          </div>

        </form>
      </div>
    </div>
  </div>
</div>
